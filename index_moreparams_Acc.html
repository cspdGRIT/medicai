<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedVoice AI - Revolutionary Medical Voice Documentation</title>
    <meta name="description" content="Transform medical documentation with AI. Zero typing, instant transcription, automatic parameter extraction, and real-time document generation.">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            overflow-x: hidden;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: #667eea;
        }

        .cta-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><defs><radialGradient id="g"><stop offset="20%" stop-opacity=".1"/><stop offset="50%" stop-opacity=".05"/><stop offset="100%" stop-opacity="0"/></radialGradient></defs><rect width="100%" height="100%" fill="url(%23g)"/></svg>');
            opacity: 0.3;
        }

        .hero-content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
            z-index: 2;
        }

        .hero h1 {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            line-height: 1.2;
        }

        .hero .subtitle {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .hero .description {
            font-size: 1.2rem;
            margin-bottom: 3rem;
            opacity: 0.8;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-buttons {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-primary {
            background: white;
            color: #667eea;
            padding: 1rem 2rem;
            border: none;
            border-radius: 30px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            padding: 1rem 2rem;
            border: 2px solid white;
            border-radius: 30px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-secondary:hover {
            background: white;
            color: #667eea;
            transform: translateY(-3px);
        }

        /* Stats Section */
        .stats {
            padding: 4rem 0;
            background: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 3rem;
            text-align: center;
        }

        .stat-item h3 {
            font-size: 3rem;
            font-weight: 800;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .stat-item p {
            font-size: 1.1rem;
            color: #666;
            font-weight: 500;
        }

        /* Features Section */
        .features {
            padding: 6rem 0;
            background: #f8fafc;
        }

        .section-title {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-title h2 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            color: #333;
        }

        .section-title p {
            font-size: 1.3rem;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 3rem;
            margin-top: 4rem;
        }

        .feature-card {
            background: white;
            padding: 3rem 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: center;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .feature-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            font-size: 2rem;
            color: white;
        }

        .feature-card h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #333;
        }

        .feature-card p {
            color: #666;
            line-height: 1.8;
            font-size: 1.1rem;
        }

        /* Demo Section */
        .demo-section {
            padding: 6rem 0;
            background: white;
        }

        .demo-container {
            background: #f8fafc;
            border-radius: 30px;
            padding: 3rem;
            margin-top: 3rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        .demo-interface {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            min-height: 600px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .demo-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 2rem;
            color: #333;
        }

        .mic-button {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            margin-bottom: 2rem;
        }

        .mic-button:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        .mic-button.recording {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .demo-status {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 2rem;
            color: #666;
        }

        .demo-output {
            width: 100%;
            max-width: 800px;
            margin-top: 2rem;
        }

        .detected-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .info-card {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .info-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .info-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: #333;
        }

        .transcript-box {
            background: #f8fafc;
            border: 2px dashed #ddd;
            border-radius: 15px;
            padding: 2rem;
            min-height: 150px;
            margin-top: 2rem;
        }

        .transcript-text {
            color: #666;
            font-style: italic;
            text-align: center;
        }

        /* How It Works */
        .how-it-works {
            padding: 6rem 0;
            background: #667eea;
            color: white;
        }

        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-top: 4rem;
        }

        .step-card {
            text-align: center;
            padding: 2rem;
        }

        .step-number {
            width: 60px;
            height: 60px;
            background: white;
            color: #667eea;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 800;
            margin: 0 auto 1.5rem;
        }

        .step-card h3 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        /* CTA Section */
        .final-cta {
            padding: 6rem 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
        }

        .final-cta h2 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
        }

        .final-cta p {
            font-size: 1.3rem;
            margin-bottom: 3rem;
            opacity: 0.9;
        }

        /* Footer */
        .footer {
            background: #333;
            color: white;
            padding: 3rem 0;
            text-align: center;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .footer-links a:hover {
            opacity: 1;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }

            .hero .subtitle {
                font-size: 1.2rem;
            }

            .hero .description {
                font-size: 1rem;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }

            .nav-links {
                display: none;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .demo-container {
                padding: 1.5rem;
            }

            .section-title h2 {
                font-size: 2rem;
            }
        }

        @keyframes fadeInScale {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(10px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .parameter-item {
            transition: all 0.3s ease;
        }

        .parameter-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateX(5px);
        }

        /* Better visual feedback for recording */
        .recording-indicator {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background: #ef4444;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        /* Enhanced demo output styling */
        .demo-output {
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 15px;
            padding: 1rem;
            background: rgba(248, 250, 252, 0.5);
        }

        .demo-output.active {
            border-color: rgba(102, 126, 234, 0.5);
            background: rgba(248, 250, 252, 0.8);
        }

        /* Demo specific styles */
        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .demo-left, .demo-right {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            min-height: 400px;
        }

        .demo-left h4, .demo-right h4 {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #333;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .parameters-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .parameter-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: #f8fafc;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .parameter-name {
            font-weight: 600;
            color: #555;
        }

        .parameter-value {
            color: #667eea;
            font-weight: 700;
        }

        .document-preview {
            background: #f8fafc;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.8rem;
            line-height: 1.4;
            color: #555;
            height: 300px;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="logo">🎤 MedVoice AI</div>
            <ul class="nav-links">
                <li><a href="#features">Features</a></li>
                <li><a href="#demo">Demo</a></li>
                <li><a href="#how-it-works">How It Works</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <a href="#demo" class="cta-button">Try Demo</a>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Revolutionary Medical Voice Documentation</h1>
            <p class="subtitle">Zero Typing. Instant Results. Complete Automation.</p>
            <p class="description">
                Transform medical documentation with AI-powered voice recognition. Just speak naturally - patient names, exam types, and medical parameters are extracted automatically, generating professional documents in real-time.
            </p>
            <div class="hero-buttons">
                <a href="#demo" class="btn-primary">
                    <i class="fas fa-play"></i> Try Live Demo
                </a>
                <a href="#features" class="btn-secondary">
                    <i class="fas fa-info-circle"></i> Learn More
                </a>
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="stats">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-item">
                    <h3>95%</h3>
                    <p>Accuracy Rate</p>
                </div>
                <div class="stat-item">
                    <h3>&lt;3s</h3>
                    <p>Processing Time</p>
                </div>
                <div class="stat-item">
                    <h3>0</h3>
                    <p>Typing Required</p>
                </div>
                <div class="stat-item">
                    <h3>100%</h3>
                    <p>Automation</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features" id="features">
        <div class="container">
            <div class="section-title fade-in">
                <h2>Cutting-Edge AI Features</h2>
                <p>Advanced medical AI that understands context, extracts parameters, and generates documents automatically</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card fade-in">
                    <div class="feature-icon">
                        <i class="fas fa-microphone"></i>
                    </div>
                    <h3>Smart Voice Recognition</h3>
                    <p>Advanced AI automatically detects patient names, exam types, and medical terminology from natural speech with 95%+ accuracy.</p>
                </div>
                
                <div class="feature-card fade-in">
                    <div class="feature-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h3>Intelligent Parameter Extraction</h3>
                    <p>Instantly extracts vital signs, measurements, and medical observations in real-time as you speak naturally.</p>
                </div>
                
                <div class="feature-card fade-in">
                    <div class="feature-icon">
                        <i class="fas fa-file-medical"></i>
                    </div>
                    <h3>Auto Document Generation</h3>
                    <p>Generates professional medical documents automatically with smart file naming: patient_name_exam_type_timestamp.docx</p>
                </div>
                
                <div class="feature-card fade-in">
                    <div class="feature-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <h3>JSON Data Export</h3>
                    <p>Structured data export in JSON format for integration with EMR systems, analytics, and medical databases.</p>
                </div>
                
                <div class="feature-card fade-in">
                    <div class="feature-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <h3>Real-Time Processing</h3>
                    <p>Live transcription and parameter extraction with parallel processing - everything happens as you speak.</p>
                </div>
                
                <div class="feature-card fade-in">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>HIPAA Ready</h3>
                    <p>Built with medical-grade security, compliance features, and privacy protection for patient data.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Demo Section -->
    <section class="demo-section" id="demo">
        <div class="container">
            <div class="section-title fade-in">
                <h2>Live Interactive Demo</h2>
                <p>Experience the power of AI-driven medical documentation. Just click the microphone and start speaking!</p>
            </div>
            
            <div class="demo-container">
                <div class="demo-interface">
                    <div class="demo-title">🎤 Medical Voice AI Demo</div>
                    
                    <button class="mic-button" id="micButton">
                        <i class="fas fa-microphone" id="micIcon"></i>
                    </button>
                    
                    <div class="demo-status" id="demoStatus">Click microphone to start recording</div>
                    
                    <div class="demo-output" id="demoOutput" style="display: none;">
                        <div class="detected-info">
                            <div class="info-card">
                                <div class="info-label">Patient Name</div>
                                <div class="info-value" id="patientName">Detecting...</div>
                            </div>
                            <div class="info-card">
                                <div class="info-label">Exam Type</div>
                                <div class="info-value" id="examType">Analyzing...</div>
                            </div>
                            <div class="info-card">
                                <div class="info-label">Status</div>
                                <div class="info-value" id="processingStatus">Processing...</div>
                            </div>
                        </div>
                        
                        <div class="demo-grid">
                            <div class="demo-left">
                                <h4><i class="fas fa-list-alt"></i> Extracted Parameters</h4>
                                <div class="parameters-list" id="parametersList">
                                    <div class="parameter-item">
                                        <span class="parameter-name">Listening for parameters...</span>
                                        <span class="parameter-value">--</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="demo-right">
                                <h4><i class="fas fa-file-alt"></i> Live Document Preview</h4>
                                <div class="document-preview" id="documentPreview">
                                    Document will generate automatically once patient name and exam type are detected...
                                </div>
                            </div>
                        </div>
                        
                        <div class="transcript-box">
                            <div class="transcript-text" id="transcriptText">
                                Live transcript will appear here as you speak...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works -->
    <section class="how-it-works" id="how-it-works">
        <div class="container">
            <div class="section-title fade-in">
                <h2>How It Works</h2>
                <p>Simple three-step process for complete medical documentation automation</p>
            </div>
            
            <div class="steps-grid">
                <div class="step-card fade-in">
                    <div class="step-number">1</div>
                    <h3>Press & Speak</h3>
                    <p>Click the microphone button and start speaking naturally about your examination. No forms, no typing required.</p>
                </div>
                
                <div class="step-card fade-in">
                    <div class="step-number">2</div>
                    <h3>AI Processes</h3>
                    <p>Advanced AI automatically detects patient name, exam type, and extracts medical parameters in real-time.</p>
                </div>
                
                <div class="step-card fade-in">
                    <div class="step-number">3</div>
                    <h3>Files Generated</h3>
                    <p>Professional documents and JSON data files are created automatically with smart naming for immediate use.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Final CTA -->
    <section class="final-cta">
        <div class="container">
            <h2>Ready to Transform Your Medical Documentation?</h2>
            <p>Join thousands of healthcare professionals already using MedVoice AI to save time and improve accuracy.</p>
            <a href="#demo" class="btn-primary" style="font-size: 1.2rem; padding: 1.2rem 2.5rem;">
                <i class="fas fa-rocket"></i> Start Free Trial
            </a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer" id="contact">
        <div class="footer-content">
            <div class="footer-links">
                <a href="#features">Features</a>
                <a href="#demo">Demo</a>
                <a href="#how-it-works">How It Works</a>
                <a href="mailto:contact@medvoiceai.com">Contact</a>
                <a href="/privacy">Privacy Policy</a>
                <a href="/terms">Terms of Service</a>
            </div>
            <p>&copy; 2025 MedVoice AI. All rights reserved. Revolutionizing medical documentation with artificial intelligence.</p>
        </div>
    </footer>

    <script>
        // Smooth scrolling animation
        document.addEventListener('DOMContentLoaded', function() {
            // Intersection Observer for animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, observerOptions);

            // Observe all fade-in elements
            document.querySelectorAll('.fade-in').forEach(el => {
                observer.observe(el);
            });
        });

        // Demo functionality
        class MedicalVoiceDemo {
            constructor() {
                this.isRecording = false;
                this.recognition = null;
                this.transcript = '';
                this.patientName = '';
                this.examType = '';
                this.parameters = {};
                
                this.initializeDemo();
            }

            initializeDemo() {
                const micButton = document.getElementById('micButton');
                const micIcon = document.getElementById('micIcon');
                
                micButton.addEventListener('click', () => {
                    if (this.isRecording) {
                        this.stopRecording();
                    } else {
                        this.startRecording();
                    }
                });

                // Initialize speech recognition if available
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.recognition = new SpeechRecognition();
                    this.recognition.continuous = true;
                    this.recognition.interimResults = true;
                    this.recognition.lang = 'en-US';
                    
                    this.recognition.onresult = (event) => {
                        this.handleSpeechResult(event);
                    };
                    
                    this.recognition.onerror = (event) => {
                        console.error('Speech recognition error:', event.error);
                        let errorMessage = 'Speech recognition error';
                        
                        switch(event.error) {
                            case 'network':
                                errorMessage = '🌐 Network error - Check internet connection';
                                break;
                            case 'not-allowed':
                                errorMessage = '🎤 Microphone access denied - Please allow microphone';
                                break;
                            case 'no-speech':
                                errorMessage = '🔇 No speech detected - Please speak louder';
                                break;
                            case 'audio-capture':
                                errorMessage = '🎤 Microphone not working - Check device';
                                break;
                            default:
                                errorMessage = `🔧 ${event.error} - Try refreshing the page`;
                        }
                        
                        this.updateStatus(errorMessage);
                        
                        // Auto-restart recognition after brief pause
                        setTimeout(() => {
                            if (this.isRecording && this.recognition) {
                                this.updateStatus('🔄 Restarting speech recognition...');
                                try {
                                    this.recognition.start();
                                } catch (e) {
                                    console.log('Could not restart recognition:', e);
                                    this.updateStatus('❌ Speech recognition unavailable - Try demo mode');
                                }
                            }
                        }, 2000);
                    };
                    
                    this.recognition.onend = () => {
                        if (this.isRecording) {
                            this.recognition.start(); // Auto-restart
                        }
                    };
                } else {
                    this.updateStatus('Speech recognition not supported - try Chrome browser');
                }
            }

            startRecording() {
                if (!this.recognition) {
                    this.simulateDemo();
                    return;
                }

                this.isRecording = true;
                this.transcript = '';
                this.patientName = '';
                this.examType = '';
                this.parameters = {};
                
                document.getElementById('micButton').classList.add('recording');
                document.getElementById('micIcon').className = 'fas fa-stop';
                document.getElementById('demoOutput').style.display = 'block';
                
                this.updateStatus('🎤 Recording - Speak naturally!');
                this.recognition.start();
            }

            stopRecording() {
                this.isRecording = false;
                
                if (this.recognition) {
                    this.recognition.stop();
                }
                
                document.getElementById('micButton').classList.remove('recording');
                document.getElementById('micIcon').className = 'fas fa-microphone';
                
                this.updateStatus('Processing complete - Ready for new recording');
            }

            handleSpeechResult(event) {
                let finalTranscript = '';
                let interimTranscript = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript + ' ';
                        this.transcript += transcript + ' ';
                        
                        // Process each sentence for better accuracy
                        this.processTranscript(transcript);
                        
                        // Update status based on what's been detected
                        this.updateProcessingStatus();
                    } else {
                        interimTranscript += transcript;
                    }
                }
                
                if (finalTranscript) {
                    this.updateTranscript();
                    this.updateDisplay();
                }
            }

            updateProcessingStatus() {
                const patientDetected = !!this.patientName;
                const examDetected = !!this.examType;
                const paramsCount = Object.keys(this.parameters).length;
                
                if (patientDetected && examDetected && paramsCount > 0) {
                    this.updateStatus(`🎯 Full automation active! ${paramsCount} parameters extracted`);
                } else if (patientDetected && examDetected) {
                    this.updateStatus('✅ Patient and exam detected - Listening for parameters...');
                } else if (patientDetected) {
                    this.updateStatus('👤 Patient detected - Analyzing exam type...');
                } else if (examDetected) {
                    this.updateStatus('🏥 Exam type detected - Listening for patient name...');
                } else {
                    this.updateStatus('🎤 Processing speech - Detecting patient and exam type...');
                }
            }

            processTranscript(text) {
                // Show immediate feedback for detected terms
                this.showLiveDetection(text);
                
                // Simulate AI processing with more realistic timing
                this.extractPatientName(text);
                this.detectExamType(text);
                this.extractParameters(text);
                this.updateDisplay();
            }

            showLiveDetection(text) {
                // Highlight detected medical terms in real-time
                const medicalTerms = [
                    'ultrasound', 'echocardiogram', 'biparietal', 'diameter', 
                    'heart rate', 'blood pressure', 'gestational', 'placenta',
                    'ejection fraction', 'ventricular', 'patient', 'examination'
                ];
                
                const detectedTerms = medicalTerms.filter(term => 
                    text.toLowerCase().includes(term)
                );
                
                if (detectedTerms.length > 0) {
                    console.log('🎯 Detected medical terms:', detectedTerms);
                    // Could add visual feedback here for detected terms
                }
            }

            extractPatientName(text) {
                if (this.patientName) return;
                
                const namePatterns = [
                    /patient\s+(?:name\s+)?(?:is\s+)?([A-Za-z]+(?:\s+[A-Za-z]+)*)/i,
                    /(?:this\s+is|examining)\s+([A-Za-z]+(?:\s+[A-Za-z]+)*)/i,
                    /([A-Za-z]+(?:\s+[A-Za-z]+)*)\s+(?:is\s+)?(?:the\s+)?patient/i
                ];

                for (let pattern of namePatterns) {
                    const match = text.match(pattern);
                    if (match) {
                        const name = match[1].trim();
                        if (this.isValidName(name)) {
                            this.patientName = name;
                            break;
                        }
                    }
                }
            }

            isValidName(name) {
                const exclusions = ['patient', 'exam', 'blood', 'pressure', 'heart', 'rate', 'normal'];
                return !exclusions.some(word => name.toLowerCase().includes(word));
            }

            detectExamType(text) {
                if (this.examType) return;
                
                const examKeywords = {
                    'Ultrasound': [
                        'ultrasound', 'sonogram', 'gestational', 'pregnancy', 'fetal', 'prenatal',
                        'biparietal', 'diameter', 'bpd', 'head circumference', 'abdominal circumference',
                        'femur length', 'estimated fetal weight', 'placenta', 'amniotic', 'weeks pregnant',
                        'GA', 'HC', 'AC', 'FL', 'EFW', 'prenatal ultrasound', 'obstetric'
                    ],
                    'MRI Brain': [
                        'mri brain', 'brain mri', 'magnetic resonance', 'brain angiogram', 'angio',
                        'flair', 'dwi', 'diffusion weighted', 'basal ganglia', 'thalami', 'cerebellum',
                        'brainstem', 'ventricular system', 'intracerebral', 'angiography', 'tof'
                    ],
                    'CT Chest': [
                        'ct chest', 'chest ct', 'hrct', 'computed tomography chest', 'lung',
                        'trachea', 'bronchi', 'mediastinal', 'lymphadenopathy', 'parenchyma',
                        'alveolar', 'interstitial', 'pleural', 'thorax'
                    ],
                    'CT Abdomen': [
                        'ct abdomen', 'abdomen ct', 'ct pelvis', 'abdominal ct', 'liver',
                        'gallbladder', 'pancreas', 'spleen', 'kidneys', 'adrenal', 'aorta',
                        'ivc', 'bladder', 'prostate', 'peritoneal'
                    ],
                    'CT Brain': [
                        'ct brain', 'brain ct', 'ct head', 'head ct', 'computed tomography brain',
                        'cerebral', 'grey matter', 'white matter', 'focal lesion', 'parenchyma',
                        'posterior fossa', 'intra-axial', 'extra-axial', 'midline shift'
                    ],
                    'MRI Spine': [
                        'mri spine', 'spine mri', 'cervical spine', 'c spine', 'mri cervical',
                        'whole spine screening', 'spinal canal', 'vertebral bodies', 'discs',
                        'thecal sac', 'neural foraminae', 'facet joints'
                    ],
                    'Echocardiogram': [
                        'echocardiogram', 'echo', 'cardiac', 'heart', 'ejection fraction', 'ventricular',
                        'valve', 'aortic', 'mitral', 'tricuspid', 'pulmonary', 'cardiology', 'ef',
                        'left ventricular', 'right ventricular', 'cardiac function', 'heart function'
                    ],
                    'General Exam': [
                        'physical exam', 'examination', 'vital signs', 'blood pressure', 'temperature',
                        'weight', 'height', 'pulse', 'general', 'checkup', 'routine', 'physical',
                        'vitals', 'assessment', 'wellness', 'health check'
                    ]
                };

                let maxScore = 0;
                let detectedExam = '';

                for (let [exam, keywords] of Object.entries(examKeywords)) {
                    const score = keywords.filter(keyword => 
                        text.toLowerCase().includes(keyword.toLowerCase())
                    ).length;
                    
                    if (score > maxScore) {
                        maxScore = score;
                        detectedExam = exam;
                    }
                }

                // Lower threshold for detection and add context scoring
                if (maxScore >= 1) {
                    // Additional context scoring
                    const textLower = text.toLowerCase();
                    
                    // Boost ultrasound score if pregnancy terms present
                    if (detectedExam === 'Ultrasound' && 
                        (textLower.includes('week') || textLower.includes('prenatal') || 
                         textLower.includes('fetal') || textLower.includes('pregnancy'))) {
                        maxScore += 2;
                    }
                    
                    // Boost echo score if cardiac terms present  
                    if (detectedExam === 'Echocardiogram' &&
                        (textLower.includes('ef') || textLower.includes('fraction') ||
                         textLower.includes('cardiac') || textLower.includes('valve'))) {
                        maxScore += 2;
                    }
                    
                    if (maxScore >= 1) {
                        this.examType = detectedExam;
                    }
                }
            }

            extractParameters(text) {
                // Enhanced patterns for better medical parameter extraction
                const paramPatterns = {
                    // General Vitals
                    'Blood Pressure': [
                        /(?:blood\s+pressure|BP)\s*(?:is\s+)?(\d+)(?:\s*over\s*|\s*\/\s*)(\d+)/i,
                        /BP\s*(\d+)\/(\d+)/i,
                        /(\d+)\s*over\s*(\d+)/i
                    ],
                    'Heart Rate': [
                        /(?:heart\s+rate|HR|pulse|FHR|fetal\s+heart\s+rate)\s*(?:is\s+)?(\d+)\s*(?:bpm|beats\s+per\s+minute|beats)?/i,
                        /(?:heart\s+rate|HR)\s*(\d+)/i,
                        /(\d+)\s*(?:bpm|beats\s+per\s+minute)/i
                    ],
                    'Temperature': [
                        /temperature\s*(?:is\s+)?(\d+\.?\d*)\s*(?:degrees?|°)?(?:\s*[CF])?/i,
                        /temp\s*(\d+\.?\d*)/i
                    ],
                    'Weight': [
                        /(?:weight|wt)\s*(?:is\s+)?(\d+\.?\d*)\s*(?:kg|kilograms?|lbs?|pounds?|grams?|g)?/i,
                        /(\d+\.?\d*)\s*(?:kg|kilograms?|grams?|g)\b/i
                    ],
                    'Height': [
                        /height\s*(?:is\s+)?(\d+\.?\d*)\s*(?:cm|centimeters?|ft|feet|inches?|in)?/i,
                        /(\d+\.?\d*)\s*(?:cm|centimeters?)/i
                    ],
                    'Age': [
                        /(?:age\s+(?:is\s+)?|patient\s+is\s+|(?:year\s+old\s+)?(?:male|female)\s+)(\d+)\s*(?:years?\s+old)?/i,
                        /(\d+)[\s-]year[\s-]old/i
                    ],

                    // Ultrasound Specific
                    'Gestational Age': [
                        /(?:gestational\s+age|GA)\s*(?:is\s+)?(\d+)\s*(?:weeks?)?\s*(?:(\d+)\s*days?)?/i,
                        /(\d+)[\s-]week\s+(?:ultrasound|prenatal|pregnancy)/i,
                        /(\d+)\s*weeks?\s*(\d+)?\s*days?\s*pregnant/i
                    ],
                    'Biparietal Diameter': [
                        /(?:biparietal\s+diameter|BPD)\s*(?:is\s+)?(?:measures\s+)?(\d+\.?\d*)\s*(?:mm|millimeters?)?/i,
                        /BPD\s*(\d+\.?\d*)/i,
                        /biparietal\s+(\d+\.?\d*)/i
                    ],
                    'Head Circumference': [
                        /(?:head\s+circumference|HC)\s*(?:is\s+)?(\d+\.?\d*)\s*(?:mm|millimeters?)?/i,
                        /HC\s*(\d+\.?\d*)/i,
                        /head\s+circumference\s+(\d+\.?\d*)/i
                    ],
                    'Abdominal Circumference': [
                        /(?:abdominal\s+circumference|AC)\s*(?:is\s+)?(\d+\.?\d*)\s*(?:mm|millimeters?)?/i,
                        /AC\s*(\d+\.?\d*)/i,
                        /abdominal\s+(\d+\.?\d*)/i
                    ],
                    'Femur Length': [
                        /(?:femur\s+length|FL)\s*(?:is\s+)?(\d+\.?\d*)\s*(?:mm|millimeters?)?/i,
                        /FL\s*(\d+\.?\d*)/i,
                        /femur\s+(\d+\.?\d*)/i
                    ],
                    'Estimated Fetal Weight': [
                        /(?:estimated\s+fetal\s+weight|EFW)\s*(?:is\s+)?(\d+\.?\d*)\s*(?:grams?|g)?/i,
                        /EFW\s*(\d+\.?\d*)/i,
                        /fetal\s+weight\s+(\d+\.?\d*)/i,
                        /estimated\s+weight\s+(\d+\.?\d*)/i
                    ],
                    'Placenta Location': [
                        /placenta\s+(?:is\s+)?(?:located\s+)?(?:at\s+)?(\w+)/i,
                        /placenta\s+(\w+)/i
                    ],
                    'Amniotic Fluid': [
                        /amniotic\s+fluid\s+(?:is\s+)?(\w+)/i,
                        /amniotic\s+(\w+)/i,
                        /fluid\s+(?:is\s+)?(\w+)/i
                    ],
                    'Presentation': [
                        /(?:fetal\s+)?presentation\s+(?:is\s+)?(\w+)/i,
                        /presentation\s+(\w+)/i
                    ],

                    // Cardiac Specific
                    'Ejection Fraction': [
                        /(?:ejection\s+fraction|EF)\s*(?:is\s+)?(\d+\.?\d*)\s*(?:%|percent)?/i,
                        /EF\s*(\d+\.?\d*)/i
                    ],
                    'Left Ventricular Function': [
                        /(?:left\s+ventricular?|LV)\s+function\s+(?:is\s+)?(\w+)/i,
                        /LV\s+function\s+(\w+)/i,
                        /left\s+ventricular\s+(\w+)/i
                    ],

                    // Radiology Specific Parameters
                    'Sex': [
                        /(?:sex|gender)\s*(?:is\s+)?(\w+)/i,
                        /(male|female|M|F)\s*patient/i,
                        /patient\s+is\s+(male|female)/i
                    ],
                    'Technique': [
                        /technique\s*:?\s*(.+?)(?:\.|findings|impression)/i,
                        /performed\s+using\s+(.+?)(?:\.|findings)/i,
                        /scanner\s+(.+?)(?:\.|findings)/i
                    ],
                    
                    // MRI Brain Parameters
                    'Basal Ganglia': [
                        /basal\s+ganglia\s+(?:and\s+thalami\s+)?(?:are\s+)?(\w+)/i,
                        /bilateral\s+basal\s+ganglia\s+(\w+)/i
                    ],
                    'Cerebellum': [
                        /cerebellum\s+(?:and\s+brainstem\s+)?(?:are\s+)?(\w+)/i,
                        /posterior\s+fossa\s+(\w+)/i
                    ],
                    'Ventricular System': [
                        /ventricular\s+system\s*,?\s*cisternal\s*&?\s*sulcal\s+spaces\s+(?:are\s+)?(\w+)/i,
                        /ventricles\s+(?:are\s+)?(\w+)/i
                    ],
                    'Angiography': [
                        /angiography\s+shows?\s*:?\s*(.+?)(?:impression|consultant)/i,
                        /arteries\s+(?:are\s+)?(\w+)/i
                    ],
                    
                    // CT Chest Parameters
                    'Trachea': [
                        /trachea\s+(?:and\s+main\s+bronchi\s+)?(?:are\s+)?(\w+)/i,
                        /bronchi\s+(?:are\s+)?(\w+)/i
                    ],
                    'Mediastinum': [
                        /mediastinal\s+(.+?)(?:\.|no)/i,
                        /lymphadenopathy\s+(\w+)/i
                    ],
                    'Lung Parenchyma': [
                        /lung\s+parenchyma\s+(.+?)(?:\.|no)/i,
                        /bilateral\s+lung\s+fields\s+(.+?)(?:\.|no)/i
                    ],
                    'Pleural': [
                        /pleural\s+(.+?)(?:\.|soft)/i,
                        /pleural\s+collection\s+(\w+)/i
                    ],
                    
                    // CT Abdomen Parameters
                    'Liver': [
                        /liver\s+is\s+(.+?)(?:\.|cbd|gallbladder)/i,
                        /liver\s+(.+?)(?:size|attenuation)/i
                    ],
                    'Gallbladder': [
                        /gallbladder\s+(.+?)(?:\.|spleen|pancreas)/i,
                        /gb\s+(.+?)(?:\.|spleen)/i
                    ],
                    'Pancreas': [
                        /pancreas\s*:?\s*(.+?)(?:\.|both\s+kidneys|kidneys)/i
                    ],
                    'Kidneys': [
                        /(?:both\s+)?kidneys\s+(?:are\s+)?(.+?)(?:\.|adrenal|aorta)/i,
                        /renal\s+(.+?)(?:\.|adrenal)/i
                    ],
                    'Spleen': [
                        /spleen\s+is\s+(.+?)(?:\.|mesentery|pancreas)/i
                    ],
                    
                    // CT Brain Parameters
                    'Cerebral Matter': [
                        /cerebral\s+grey\s+and\s+white\s+matter\s+(.+?)(?:\.|basal)/i,
                        /cerebral\s+parenchyma\s+(.+?)(?:\.|basal)/i
                    ],
                    'Posterior Fossa': [
                        /posterior\s+fossa\s+structures\s+(.+?)(?:\.|ventricular)/i,
                        /brain\s+stem\s+and\s+cerebellum\s+(.+?)(?:\.|ventricular)/i
                    ],
                    
                    // MRI Spine Parameters
                    'Curvature': [
                        /curvature\s+of\s+spine\s+is\s+(.+?)(?:\.|canal)/i,
                        /spinal\s+curvature\s+(.+?)(?:\.|canal)/i
                    ],
                    'Canal Diameters': [
                        /canal\s+diameters\s+(.+?)(?:mm|whole\s+spine)/i,
                        /ap\s+(\d+\.?\d*)\s*mm/i
                    ],
                    'Vertebral Bodies': [
                        /vertebral\s+bodies\s+(.+?)(?:\.|configuration)/i,
                        /alignment\s*,?\s*heights\s+(.+?)(?:\.|configuration)/i
                    ],
                    'Discs': [
                        /discs?\s*,?\s*thecal\s+sac\s+(.+?)(?:\.|impression)/i,
                        /disc\s+(.+?)(?:\.|thecal)/i
                    ],
                    
                    // Impression (common to all)
                    'Impression': [
                        /impression\s*:?\s*(.+?)(?:consultant|dr\.|radiologist)/i,
                        /conclusion\s*:?\s*(.+?)(?:consultant|dr\.)/i
                    ]
                };

                // Process each parameter with multiple patterns
                for (let [paramName, patterns] of Object.entries(paramPatterns)) {
                    // Skip if already found
                    if (this.parameters[paramName]) continue;
                    
                    for (let pattern of patterns) {
                        const match = text.match(pattern);
                        if (match) {
                            let value;
                            
                            // Handle special cases
                            if (paramName === 'Blood Pressure' && match[2]) {
                                value = `${match[1]}/${match[2]}`;
                            } else if (paramName === 'Gestational Age' && match[2]) {
                                value = `${match[1]} weeks ${match[2]} days`;
                            } else if (paramName === 'Gestational Age' && match[1]) {
                                value = `${match[1]} weeks`;
                            } else {
                                value = match[1];
                            }
                            
                            // Add units for measurements
                            if (['Biparietal Diameter', 'Head Circumference', 'Abdominal Circumference', 'Femur Length'].includes(paramName)) {
                                value += ' mm';
                            } else if (paramName === 'Estimated Fetal Weight') {
                                value += ' grams';
                            } else if (paramName === 'Heart Rate') {
                                value += ' bpm';
                            } else if (paramName === 'Ejection Fraction') {
                                value += '%';
                            } else if (paramName === 'Temperature') {
                                value += '°F';
                            } else if (paramName === 'Weight' && !text.toLowerCase().includes('gram')) {
                                value += ' kg';
                            } else if (paramName === 'Height') {
                                value += ' cm';
                            }
                            
                            this.parameters[paramName] = value;
                            break; // Found match, move to next parameter
                        }
                    }
                }
            }

            updateDisplay() {
                // Update patient name
                document.getElementById('patientName').textContent = 
                    this.patientName || 'Listening...';
                
                // Update exam type
                document.getElementById('examType').textContent = 
                    this.examType || 'Analyzing...';
                
                // Update status
                if (this.patientName && this.examType) {
                    document.getElementById('processingStatus').textContent = 'Full automation active!';
                } else {
                    document.getElementById('processingStatus').textContent = 'Detecting...';
                }
                
                // Update parameters
                this.updateParametersList();
                
                // Update document preview
                this.updateDocumentPreview();
            }

            updateParametersList() {
                const paramsList = document.getElementById('parametersList');
                
                if (Object.keys(this.parameters).length === 0) {
                    paramsList.innerHTML = `
                        <div class="parameter-item">
                            <span class="parameter-name">🎤 Listening for medical parameters...</span>
                            <span class="parameter-value">--</span>
                        </div>
                    `;
                    return;
                }

                paramsList.innerHTML = '';
                
                // Sort parameters by importance for medical display
                const parameterOrder = [
                    'Patient Name', 'Gestational Age', 'Biparietal Diameter', 
                    'Head Circumference', 'Abdominal Circumference', 'Femur Length',
                    'Estimated Fetal Weight', 'Heart Rate', 'Blood Pressure',
                    'Ejection Fraction', 'Left Ventricular Function', 
                    'Placenta Location', 'Amniotic Fluid', 'Presentation',
                    'Temperature', 'Weight', 'Height', 'Age'
                ];
                
                // Add found parameters in order
                for (let paramName of parameterOrder) {
                    if (this.parameters[paramName]) {
                        paramsList.innerHTML += `
                            <div class="parameter-item" style="animation: fadeInScale 0.5s ease-out;">
                                <span class="parameter-name">✅ ${paramName}</span>
                                <span class="parameter-value">${this.parameters[paramName]}</span>
                            </div>
                        `;
                    }
                }
                
                // Add any remaining parameters not in the order list
                for (let [name, value] of Object.entries(this.parameters)) {
                    if (!parameterOrder.includes(name)) {
                        paramsList.innerHTML += `
                            <div class="parameter-item" style="animation: fadeInScale 0.5s ease-out;">
                                <span class="parameter-name">✅ ${name}</span>
                                <span class="parameter-value">${value}</span>
                            </div>
                        `;
                    }
                }
            }

            updateDocumentPreview() {
                const preview = document.getElementById('documentPreview');
                
                if (!this.patientName || !this.examType) {
                    preview.textContent = 'Document will generate once patient and exam type are detected...';
                    return;
                }

                const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                const filename = `${this.patientName.replace(/\s+/g, '_')}_${this.examType.replace(/\s+/g, '_').toLowerCase()}_${timestamp}`;

                let documentContent = this.generateMedicalReport();
                preview.textContent = documentContent;
                
                // Show download button
                this.showDownloadButton(filename, documentContent);
            }

            generateMedicalReport() {
                const date = new Date().toLocaleDateString('en-IN');
                const time = new Date().toLocaleTimeString('en-IN');
                
                switch (this.examType) {
                    case 'MRI Brain':
                        return this.generateMRIBrainReport(date, time);
                    case 'CT Chest':
                        return this.generateCTChestReport(date, time);
                    case 'CT Abdomen':
                        return this.generateCTAbdomenReport(date, time);
                    case 'CT Brain':
                        return this.generateCTBrainReport(date, time);
                    case 'MRI Spine':
                        return this.generateMRISpineReport(date, time);
                    case 'Ultrasound':
                        return this.generateUltrasoundReport(date, time);
                    case 'Echocardiogram':
                        return this.generateEchoReport(date, time);
                    default:
                        return this.generateGeneralReport(date, time);
                }
            }

            generateMRIBrainReport(date, time) {
                const age = this.parameters['Age'] || '[Age]';
                const sex = this.parameters['Sex'] || '[Sex]';
                
                return `**Name: ${this.patientName} Sex: ${sex} Age: ${age} Yrs Date: ${date}**

**Reff.By: Dr. UHID: UH**

**DEPARTMENT OF RADIO-DIAGNOSIS**

**MRI BRAIN PLAIN (ANGIOGRAM)**

**TECHNIQUE:**
T2 FSE Axials / Sagittals & Coronals.T1 &T2 FLAIR Axials. DWI, GRE Axials.
3D TOF MR Angiography of Intra + Extracranial Arteries.

**FINDINGS:**
No restriction is seen on diffusion weighted images to suggest acute infarct.
No intracerebral hemorrhage is noted.
Bilateral basal ganglia and thalami are ${this.parameters['Basal Ganglia'] || 'normal'}.
Cerebellum and brainstem are ${this.parameters['Cerebellum'] || 'unremarkable'}.
The ventricular system, cisternal & sulcal spaces are ${this.parameters['Ventricular System'] || 'normal'}.

**MR ANGIOGRAPHY SHOWS:**
${this.parameters['Angiography'] || 'Bilateral intracranial internal carotid arteries, anterior & middle cerebral arteries and their branches are normal in caliber/flow signal. The basilar artery and bilateral posterior cerebral arteries are normal in caliber and course. Both vertebral arteries are normal in calibre and flow signal.'}

**IMPRESSION:**
- ${this.parameters['Impression'] || 'No significant brain parenchymal abnormality detected.'}

---Suggested clinical correlation / further evaluation if clinically indicated.

**CONSULTANT RADIOLOGIST**
**DR. VISHRUTH RASA. M.D. RADIOLOGY**

Generated: ${date} ${time}`;
            }

            generateCTChestReport(date, time) {
                const age = this.parameters['Age'] || '[Age]';
                const sex = this.parameters['Sex'] || 'F';
                
                return `**Name: ${this.patientName} Sex: ${sex} Age: ${age} Yrs Date: ${date}**

**Reff.By: UHID: UH**

**DEPARTMENT OF RADIO-DIAGNOSIS**

**CT CHEST PLAIN**

**TECHNIQUE:**
CT scan of the chest was performed on 96 slice MDCT scanner using 0.625mm detector collimation. Coronal & sagittal reconstructions were performed at 2.5mm intervals.

**FINDINGS:**
Trachea and main bronchi are ${this.parameters['Trachea'] || 'normal in caliber and course with no endobronchial lesions seen'}.
Mediastinal vascular structures are ${this.parameters['Mediastinum'] || 'within normal limits'}.
No significant mediastinal lymphadenopathy seen.
Lung parenchyma ${this.parameters['Lung Parenchyma'] || 'does not reveal any alveolar, interstitial or airway disease'}.
${this.parameters['Pleural'] || 'No pleural collection seen'}.
Soft tissues and bony cage are normal.

**IMPRESSION:**
- ${this.parameters['Impression'] || 'No focal lesions in bilateral lung fields.'}

---Suggested clinical correlation / further evaluation if clinically indicated.

**CONSULTANT RADIOLOGIST**
**DR. VISHRUTH RASA. M.D. RADIOLOGY**

Generated: ${date} ${time}`;
            }

            generateCTAbdomenReport(date, time) {
                const age = this.parameters['Age'] || '[Age]';
                const sex = this.parameters['Sex'] || 'M/F';
                
                return `**Name: ${this.patientName} Sex: ${sex} Age: ${age} Yrs Date: ${date}**

**Reff.By.Dr: UHID:**

**DEPARTMENT OF RADIO-DIAGNOSIS**

**CT ABDOMEN AND PELVIS PLAIN**

**TECHNIQUE:** CT abdomen plain study was performed on 96 slice MDCT scanner with detector collimation of 0.625mm, 1mm reconstruction in saggital and coronal planes.

**FINDINGS:**
Liver is ${this.parameters['Liver'] || 'normal in size and attenuation. No IHBRD'}.
CBD normal in caliber.
Gallbladder ${this.parameters['Gallbladder'] || 'is well distended. Wall thickness appears normal. No e/o hyperdense calculi'}.
Spleen is ${this.parameters['Spleen'] || 'normal in size and attenuation'}.
Mesentery and omentum are normal.
Pancreas: ${this.parameters['Pancreas'] || 'Normal in size, shape and attenuation. No e/o ductal dilatation, parenchymal calcifications and peripancreatic fluid collection'}.
Both kidneys ${this.parameters['Kidneys'] || 'are normal in size, shape and attenuation. No hydronephrosis / calculi'}.
Both adrenal glands appear normal.
Aorta and IVC are normal.
Urinary bladder is normal in contours. No filling defects noted. No calculi. Wall thickness appears normal.
Prostate is normal in size and attenuation.
No free fluid in the peritoneal cavity.

**IMPRESSION:**
- ${this.parameters['Impression'] || 'No significant abnormality detected.'}

**CONSULTANT RADIOLOGIST**
**DR. VISHRUTH RASA. M.D. RADIOLOGY**

Generated: ${date} ${time}`;
            }

            generateCTBrainReport(date, time) {
                const age = this.parameters['Age'] || '[Age]';
                const sex = this.parameters['Sex'] || 'M';
                
                return `**Name: ${this.patientName} Sex: ${sex} Age: ${age} Yrs Date: ${date}**

**Reff.By: UHID:**

**DEPARTMENT OF RADIO-DIAGNOSIS**

**CT BRAIN PLAIN**

**TECHNIQUE:** CT scan of brain was performed on 96 slice MDCT scanner.

**FINDINGS:**
The cerebral grey and white matter ${this.parameters['Cerebral Matter'] || 'appear normal. No focal lesion is seen in the cerebral parenchyma'}.
The basal ganglia and thalami are ${this.parameters['Basal Ganglia'] || 'normal'}.
The posterior fossa structures ${this.parameters['Posterior Fossa'] || 'including the brain stem and cerebellum do not show any abnormality'}.
The ventricular system, cisternal & sulcal spaces are ${this.parameters['Ventricular System'] || 'normal'}.
No intra / extra-axial bleed seen.
No midline shift / herniations noted.
Skull bones are unremarkable.

**IMPRESSION:**
- ${this.parameters['Impression'] || 'No significant brain parenchymal abnormality detected.'}

---Suggested clinical correlation/further evaluation if clinically indicated.

**CONSULTANT RADIOLOGIST**
**DR. VISHRUTH RASA. M.D. RADIOLOGY**

Generated: ${date} ${time}`;
            }

            generateMRISpineReport(date, time) {
                const age = this.parameters['Age'] || '[Age]';
                const sex = this.parameters['Sex'] || '[Sex]';
                
                return `**Name: ${this.patientName} Sex: ${sex} Age: ${age} Yrs Date: ${date}**

**Reff.By.Dr: UHID:**

**DEPARTMENT OF RADIO-DIAGNOSIS**

**MRI CERVICAL SPINE WITH WHOLE SPINE SCREENING**

**TECHNIQUE:** T1-T2 sagittal & axials, IR coronals.

**FINDINGS:**
Curvature of spine is ${this.parameters['Curvature'] || 'well maintained'}.

**Canal diameters are as below:**
${this.parameters['Canal Diameters'] || `
Level     C2-C3   C3-C4   C4-C5   C5-C6   C6-C7
AP Mm     13      13      8.7     11      9.5`}

**WHOLE SPINE SCREENING:**
Alignment, heights and bone marrow signal intensity of rest of the cervical vertebral bodies ${this.parameters['Vertebral Bodies'] || 'are within normal limits'}.
Configuration of rest of the discs, thecal sac, filar roots, lateral recesses, neural foraminae, neural arches, facet joints and posterior elements ${this.parameters['Discs'] || 'are within normal limits'}.

**IMPRESSION:**
- ${this.parameters['Impression'] || 'No significant abnormality detected.'}

**CONSULTANT RADIOLOGIST**
**DR. VISHRUTH RASA. M.D. RADIOLOGY**

Generated: ${date} ${time}`;
            }

            generateUltrasoundReport(date, time) {
                return `# Ultrasound Examination Report

**Patient:** ${this.patientName}
**Date:** ${date}
**Time:** ${time}

## Biometric Measurements
${this.parameters['Gestational Age'] ? `• Gestational Age: ${this.parameters['Gestational Age']}` : ''}
${this.parameters['Biparietal Diameter'] ? `• Biparietal Diameter (BPD): ${this.parameters['Biparietal Diameter']}` : ''}
${this.parameters['Head Circumference'] ? `• Head Circumference (HC): ${this.parameters['Head Circumference']}` : ''}
${this.parameters['Abdominal Circumference'] ? `• Abdominal Circumference (AC): ${this.parameters['Abdominal Circumference']}` : ''}
${this.parameters['Femur Length'] ? `• Femur Length (FL): ${this.parameters['Femur Length']}` : ''}
${this.parameters['Estimated Fetal Weight'] ? `• Estimated Fetal Weight: ${this.parameters['Estimated Fetal Weight']}` : ''}

## Fetal Assessment
${this.parameters['Heart Rate'] ? `• Heart Rate: ${this.parameters['Heart Rate']}` : ''}
${this.parameters['Placenta Location'] ? `• Placenta Location: ${this.parameters['Placenta Location']}` : ''}
${this.parameters['Amniotic Fluid'] ? `• Amniotic Fluid: ${this.parameters['Amniotic Fluid']}` : ''}

## Complete Transcript
${this.transcript}

*Generated automatically: ${date} ${time}*`;
            }

            generateEchoReport(date, time) {
                return `# Echocardiogram Report

**Patient:** ${this.patientName}
**Date:** ${date}

## Cardiac Function  
${this.parameters['Ejection Fraction'] ? `• Ejection Fraction: ${this.parameters['Ejection Fraction']}` : ''}
${this.parameters['Left Ventricular Function'] ? `• LV Function: ${this.parameters['Left Ventricular Function']}` : ''}
${this.parameters['Heart Rate'] ? `• Heart Rate: ${this.parameters['Heart Rate']}` : ''}
${this.parameters['Blood Pressure'] ? `• Blood Pressure: ${this.parameters['Blood Pressure']}` : ''}

## Complete Study
${this.transcript}

*Generated automatically: ${date} ${time}*`;
            }

            generateGeneralReport(date, time) {
                return `# Medical Examination Report

**Patient:** ${this.patientName}
**Date:** ${date}
**Time:** ${time}

## Vital Signs
${this.parameters['Age'] ? `• Age: ${this.parameters['Age']} years` : ''}
${this.parameters['Weight'] ? `• Weight: ${this.parameters['Weight']}` : ''}
${this.parameters['Height'] ? `• Height: ${this.parameters['Height']}` : ''}
${this.parameters['Blood Pressure'] ? `• Blood Pressure: ${this.parameters['Blood Pressure']}` : ''}
${this.parameters['Heart Rate'] ? `• Heart Rate: ${this.parameters['Heart Rate']}` : ''}
${this.parameters['Temperature'] ? `• Temperature: ${this.parameters['Temperature']}` : ''}

## Examination Notes
${this.transcript}

*Generated automatically: ${date} ${time}*`;
            }

            showDownloadButton(filename, content) {
                // Remove existing download button
                const existingBtn = document.getElementById('downloadBtn');
                if (existingBtn) {
                    existingBtn.remove();
                }

                // Create download button
                const downloadBtn = document.createElement('button');
                downloadBtn.id = 'downloadBtn';
                downloadBtn.className = 'px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition-colors flex items-center text-sm mt-4';
                downloadBtn.innerHTML = '<i class="fas fa-download mr-2"></i>Download Report (.txt)';
                
                downloadBtn.onclick = () => {
                    this.downloadFile(filename + '.txt', content);
                };

                // Add button after document preview
                const preview = document.getElementById('documentPreview');
                preview.parentNode.appendChild(downloadBtn);
            }

            downloadFile(filename, content) {
                const blob = new Blob([content], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                // Show success message
                this.showSuccessMessage(`Report downloaded: ${filename}`);
            }

            showSuccessMessage(message) {
                // Create success notification
                const notification = document.createElement('div');
                notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                notification.innerHTML = `<i class="fas fa-check-circle mr-2"></i>${message}`;
                
                document.body.appendChild(notification);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 3000);
            }

            updateTranscript() {
                document.getElementById('transcriptText').textContent = 
                    this.transcript || 'Live transcript will appear here...';
            }

            updateStatus(status) {
                document.getElementById('demoStatus').textContent = status;
            }

            // Simulate demo for browsers without speech recognition
            simulateDemo() {
                this.isRecording = true;
                document.getElementById('micButton').classList.add('recording');
                document.getElementById('micIcon').className = 'fas fa-stop';
                document.getElementById('demoOutput').style.display = 'block';
                
                this.updateStatus('🎤 Demo Mode - Simulating enhanced voice input...');
                
                // Enhanced simulation with more realistic medical speech
                const simulatedSpeech = [
                    "Patient Jennifer Martinez is here for her ultrasound examination",
                    "This is a 32-week prenatal ultrasound assessment",
                    "Biparietal diameter measures 84.2 millimeters",
                    "Head circumference is 295 millimeters",
                    "Abdominal circumference 275 millimeters", 
                    "Femur length 63.8 millimeters",
                    "Estimated fetal weight is 1850 grams",
                    "Fetal heart rate is 142 beats per minute",
                    "Placenta is located anteriorly",
                    "Amniotic fluid appears normal"
                ];

                let index = 0;
                const interval = setInterval(() => {
                    if (index < simulatedSpeech.length && this.isRecording) {
                        const text = simulatedSpeech[index];
                        this.transcript += text + ' ';
                        this.processTranscript(text);
                        this.updateTranscript();
                        this.updateDisplay();
                        this.updateProcessingStatus();
                        index++;
                    } else {
                        clearInterval(interval);
                        if (this.isRecording) {
                            this.updateStatus('✅ Demo complete - All parameters extracted successfully!');
                        }
                    }
                }, 1500); // Slower for better demo effect
            }
        }

        // Initialize demo when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            new MedicalVoiceDemo();
        });
    </script>
</body>
</html>